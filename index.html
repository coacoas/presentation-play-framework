<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Play Framework</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/sky.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
                <section>
                    <h1>Play Framework</h1>
                    <h3>High Performance Scalable Web System</h3>
                </section>

                <section>
                    <h2>What is Play?</h2>
                    <ul class="fragment" width="100%">
                        <li>Not a library</li>
                        <li>Not a servlet container</li>
                        <li>Not Java EE</li>
                    </ul>
                </section>
                <section>
                    <section>
                        <h2>What is Play?</h2>
                        <div>
                            <p align="left">
                                The Play Framework is a clean alternative to the legacy Enterprise Java stacks. It focuses on developer productivity, modern web and mobile applications, and predictable, minimal resource consumption (CPU, memory, threads) resulting in highly performant, highly scalable applications.
                            </p>
                            <p class="small" align="right">
                                <i>- <a href="http://www.typesafe.com/platform/runtime/playframework">http://www.typesafe.com/platform/runtime/playframework</a></i>
                            </p>
                        </div>
                        <div>
                            <p align="left">
                                Play is based on a lightweight, stateless, web-friendly architecture and features predictable and minimal resource consumption (CPU, memory, threads) for highly-scalable applications thanks to its reactive model, based on Iteratee IO.
                            </p>
                            <p align="right">
                                 <i>- <a href="http://www.playframework.com/documentation/2.3.2/Home">http://www.playframework.com/documentation</a></i>
                            </p>
                        </div>

                    </section>
                    <section>
                        <h3>What does that mean?</h3>
                        <div>
                            <p class="fragment" align="left">
                                Play supports building web services at massive scale using Java and Scala, while maintaining performance, reliability, and developer productivity.
                            </p>
                        </div>
                    </section>
                </section>
                <section>
                    <h3>Agenda</h3>
                    <ul>
                        <li>Getting Started</li>
                        <li>Development Process</li>
                        <li>Error Handling</li>
                        <li>Database</li>
                        <li>Reactive Architecture (Non-Blocking IO)</li>
                        <li>Web Services</li>
                        <li>Real-time Communications
                            <ul>
                                <li>Server-Sent Events</li>
                                <li>Websockets</li>
                            </ul>
                        </li>
                        <li>Community</li>
                    </ul>
                </section>
                <section>
                    <section>
                        <h3>Agenda</h3>
                        <ul>
                            <li><b>Getting Started</b></li>
                            <li>Development Process</li>
                            <li>Error Handling</li>
                            <li>Database</li>
                            <li>Reactive Architecture (Non-Blocking IO)</li>
                            <li>Web Services</li>
                            <li>Real-time Communications
                                <ul>
                                    <li>Server-Sent Events</li>
                                    <li>Websockets</li>
                                </ul>
                            </li>
                            <li>Community</li>
                        </ul>

                    </section>
                    <section>
                        <h2>Getting Started</h2>
                        <img src="images/playframework.com.png" alt="playframework.com"/>
                    </section>
                    <section>
                        <img src="images/activator-new.png" alt="activator new"/>
                        <p>activator new</p>
                    </section>
                    <section>
                        <img src="images/activator-ui.png" alt="activator ui"/>
                        <p>activator ui</p>
                        <p class="fragment">...or you could just use your IDE</p>
                    </section>
                    <section>
                        <ul>
                            <li>activator run - Start the server in development mode</li>
                            <li>activator stage - Generate a distribution</li>
                            <li>activator dist - zip the staged distribution</li>
                            <li>activator start - Start the server in production mode</li>
                        </ul>
                    </section>
                </section>
                <section>
                    <section>
                        <h3>Agenda</h3>
                        <ul>
                            <li>Getting Started</li>
                            <li><b>Development Process</b></li>
                            <li>Error Handling</li>
                            <li>Database</li>
                            <li>Reactive Architecture (Non-Blocking IO)</li>
                            <li>Web Services</li>
                            <li>Real-time Communications
                                <ul>
                                    <li>Server-Sent Events</li>
                                    <li>Websockets</li>
                                </ul>
                            </li>
                            <li>Community</li>
                        </ul>
                    </section>
                    <section>
                        <h3>Routes</h3>
                        <pre><code>
# Home page
GET     /                           controllers.Application.index()
GET     /hello                      controllers.Application.hello(name)
GET     /hello/:name                controllers.Application.hello(name)

# Map static resources from the /public folder to the /aServer-Sent Eventsts URL path
GET     /aServer-Sent Eventsts/*file               controllers.AServer-Sent Eventsts.at(path="/public", file)
                        </code></pre>
                    </section>
                    <section>
                        <h3>Controller</h3>
                        <pre><code>
package controllers;

import play.*;
import play.mvc.*;

import views.html.*;

public class Application extends Controller {

    public static Result index() {
        return ok(index.render("Your new application is ready."));
    }

    public static Result hello(String name) {
        return ok("Hello, " + name);
    }
}
                        </code></pre>
                    </section>
                    <section>
                        <h3>Views</h3>
                        <pre><code>
@(name: String)

&lt;html>
    &lt;head>
        &lt;title>Hello, World!&lt;/title>
    &lt;/head>
    &lt;body>
        &lt;img src="images/jaxjug.png" alt="">
        &lt;p>Hello, @name!&lt;/p>
    &lt;/body>
&lt;/html>
                        </code></pre>
                    </section>
                </section>
                <section>
                    <section>
                        <h3>Agenda</h3>
                        <ul>
                            <li>Getting Started</li>
                            <li>Development Process</li>
                            <li><b>Error Handling</b></li>
                            <li>Database</li>
                            <li>Reactive Architecture (Non-Blocking IO)</li>
                            <li>Web Services</li>
                            <li>Real-time Communications
                                <ul>
                                    <li>Server-Sent Events</li>
                                    <li>Websockets</li>
                                </ul>
                            </li>
                            <li>Community</li>
                        </ul>

                    </section>
                    <section>
                        <img src="images/play-controller-compilation-error.png" alt="Controller Compilation error"/>
                    </section>
                    <section>
                        <img src="images/play-compilation-error.png" alt="View Compilation error"/>
                    </section>
                    <section>
                        <img src="images/play-routes-compilation-error.png" alt="Routes Compilation error"/>
                    </section>
                </section>
                <section>
                    <section>
                        <h3>Agenda</h3>
                        <ul>
                            <li>Getting Started</li>
                            <li>Development Process</li>
                            <li>Error Handling</li>
                            <li><b>Database</b></li>
                            <li>Reactive Architecture (Non-Blocking IO)</li>
                            <li>Web Services</li>
                            <li>Real-time Communications
                                <ul>
                                    <li>Server-Sent Events</li>
                                    <li>Websockets</li>
                                </ul>
                            </li>
                            <li>Community</li>
                        </ul>

                    </section>
                    <section>
                        <pre><code>
# Database configuration
# ~~~~~
# You can declare as many datasources as you want.
# By convention, the default datasource is named `default`
#
db.default.driver=org.h2.Driver
db.default.url="jdbc:h2:mem:play"
# db.default.user=sa
# db.default.password=""
                        </code></pre>
                        <p>conf/application.conf</p>
                    </section>
                    <section>
                        <h3>Ebean</h3>
                        <p>Play Framework ORM for Play/Java Projects</p>
                        <div class="fragment">
                            <p>Define Models</p>
                            <pre><code>ebean.default="models.*"</code></pre>
                        </div>
                        <div class="fragment">
                            <p>Create classes</p>
                            <pre><code>
package models;

import java.util.*;
import javax.persistence.*;

import play.db.ebean.*;
import play.data.format.*;
import play.data.validation.*;

@Entity
public class Task extends Model {

    @Id
    @Constraints.Min(10)
    public Long id;

    @Constraints.Required
    public String name;

    public boolean done;

    @Formats.DateTime(pattern="dd/MM/yyyy")
    public Date dueDate = new Date();

    public static Finder&lt;Long,Task> find = new Finder&lt;Long,Task>( Long.class, Task.class );

}
                            </code></pre>
                        </div>
                    </section>
                    <section>
                        <div>
                            <p>Simple lookups</p>
                            <pre><code>Task t = Task.find.byId(4l);
List&lt;Task> ts = Task.find.all();</code></pre>
                        </div>
                        <div class="fragment">
                            <p>Powerful query language</p>
                            <pre><code>
List&lt;Task> tasks = find.where()
    .ilike("name", "%coco%")
    .orderBy("dueDate asc")
    .findPagingList(25)
    .setFetchAhead(false)
    .getPage(1)
    .getList();
                            </code></pre>
                        </div>
                    </section>
                    <section>
                        <div>
                            <h3>Anorm</h3>
                            <h6>Anorm is Not an Object Relational Mapper</h6>
                        </div>
                        <div>
                            <ul>
                                <li>Play Framework Database Access for Play/Scala Projects</li>
                                <li>The best interface to a database is SQL
                                    <pre><code lang="scala">
import anorm._
import play.api.db.DB

DB.withConnection { implicit c =>
    val result: Boolean = SQL("Select 1").execute()
}
                                    </code></pre>
                                </li>
                            </ul>
                        </div>
                    </section>
                    <section>
                        <p>Use {} for variable substitution</p>
                        <pre><code>
SQL(
"""
select * from Country c
join CountryLanguage l on l.CountryCode = c.Code
where c.code = {countryCode};
"""
).on("countryCode" -> "FRA")
                        </code></pre>
                        <p>Retrieve data and process with pattern matching</p>
                        <pre><code>
case class SmallCountry(name:String)
case class BigCountry(name:String)
case class France

val countries = SQL("Select name,population from Country")().collect {
    case Row("France", _) => France()
    case Row(name:String, pop:Int) if(pop > 1000000) => BigCountry(name)
    case Row(name:String, _) => SmallCountry(name)
}
                        </code></pre>
                    </section>
                </section>
                <section>
                    <section>
                        <h3>Agenda</h3>
                        <ul>
                            <li>Getting Started</li>
                            <li>Development Process</li>
                            <li>Error Handling</li>
                            <li>Database</li>
                            <li><b>Reactive Architecture (Non-Blocking IO)</b></li>
                            <li>Web Services</li>
                            <li>Real-time Communications
                                <ul>
                                    <li>Server-Sent Events</li>
                                    <li>Websockets</li>
                                </ul>
                            </li>
                            <li>Community</li>
                        </ul>

                    </section>
                    <section>
                        <h3>What is Reactive?</h3>
                        <p><a href="http://www.reactivemanifesto.org">http://www.reactivemanifesto.org</a></p>
                        <img src="images/full-reactive.png" alt="Image courtesy of reactivemanifesto.org"/>
                    </section>
                    <section>
                        <h3>How is Play Reactive?</h3>
                        <div align="left">
                            <ul>
                                <li class="fragment">Traditional web servers allocate one thread per connection</li>
                                <li class="fragment">If things back up, more threads get allocated</li>
                                <li class="fragment">This causes things to get worse</li>
                            </ul>
                        </div>
                    </section>
                    <section>
                        <h3>How is Play Reactive?</h3>
                        <div align="left">
                            <ul>
                                <li class="fragment">Play does not allocate threads per connection</li>
                                <li class="fragment">Built on top of Netty and Akka</li>
                                <li class="fragment">Code becomes non-blocking, allowing for more efficient use of resources</li>
                            </ul>
                        </div>
                    </section>
                    <section>
                        <h3>How is Play Reactive?</h3>
                        <pre><code>
public static F.Promise&lt;Result> timing() {
    long start = System.currentTimeMillis();
    F.Function&lt;WSResponse, Long> timing = response -> System.currentTimeMillis() - start;

    F.Promise&lt;Long> yahoo = WS.url("http://www.yahoo.com").get().map(timing);
    F.Promise&lt;Long> google = WS.url("http://www.google.com").get().map(timing);
    F.Promise&lt;Long> bing = WS.url("http://www.bing.com").get().map(timing);

    return F.Promise.sequence(yahoo, google, bing).map(timings -> {
        Map&lt;String, Long> map = new HashMap&lt;>();
        map.put("yahoo", yahoo.get(10));
        map.put("google", google.get(10));
        map.put("bing", bing.get(10));
        map.put("total", System.currentTimeMillis() -start);

        return ok(Json.toJson(map));
    });
}

                        </code></pre>
                    </section>
                </section>
                <section>
                    <section>
                        <h3>Agenda</h3>
                        <ul>
                            <li>Getting Started</li>
                            <li>Development Process</li>
                            <li>Error Handling</li>
                            <li>Database</li>
                            <li>Reactive Architecture (Non-Blocking IO)</li>
                            <li><b>Web Services</b></li>
                            <li>Real-time Communications
                                <ul>
                                    <li>Server-Sent Events</li>
                                    <li>Websockets</li>
                                </ul>
                            </li>
                            <li>Community</li>
                        </ul>

                    </section>
                    <section>
                        <h3>WS</h3>
                        <div align="left">
                            <p>Play contains the <code>play.libs.ws.WS</code> library for interfacing with web services</p>
                            <p>JSON parsing provided through the Jackson library</p>
                            <pre><code>
public static Result sayHello() {
    ObjectNode result = Json.newObject();
    result.put("exampleField1", "foobar");
    result.put("exampleField2", "Hello world!");
    return ok(result);
}

public static Result sayHello() {
    JsonNode json = request().body().asJson();
    if(json == null) {
        return badRequest("Expecting Json data");
    } else {
        String name = json.findPath("name").textValue();
        if(name == null) {
            return badRequest("Missing parameter [name]");
        } else {
            return ok("Hello " + name);
        }
    }
}
                            </code></pre>
                        </div>
                    </section>
                    <section>
                        <h3>...and Scala?</h3>
                        <p>JSON processing provided by the Jerkson library</p>
                        <pre><code>
WS.url(s"https://api.twitter.com/1.1/search/tweets.json").
    sign(signature).
    withQueryString(
        "q" -> query,
        "count" -> 20.toString,
        "result_type" -> "mixed",
        "lang" -> "en").
    get.map { response =>
        val json = Json.parse(response.body)
        val tweets = (json \ "statuses").as[JsArray].value.
        map(simplifyResponse)

        Ok(views.html.twittersearch.render(query,
            tweets.map(tweet =>
            s"${tweet \ "tweet"} - ${tweet \ "name"}")))
    }
                        </code></pre>
                    </section>
                </section>
                <section>
                    <section>
                        <h3>Agenda</h3>
                        <ul>
                            <li>Getting Started</li>
                            <li>Development Process</li>
                            <li>Error Handling</li>
                            <li>Database</li>
                            <li>Reactive Architecture (Non-Blocking IO)</li>
                            <li>Web Services</li>
                            <li><b>Real-time Communications</b>
                                <ul>
                                    <li>Server-Sent Events</li>
                                    <li>Websockets</li>
                                </ul>
                            </li>
                            <li>Community</li>
                        </ul>

                    </section>
                    <section>
                        <h3>Server-Sent Events (SSE)</h3>
                        <div align="left">
                            <ul>
                                <li>One-way streaming communicatoins (server => client)</li>
                                <li>Uses standard HTTP (Content-Type: text/event-stream) </li>
                                <li>Efficient and easy to debug</li>
                                <li>Not supported natively on all browsers (thanks, IE!)</li>
                            </ul>
                        </div>
                    </section>
                    <section>
                        <h3>Iteratees</h3>
                        <div align="left">
                            <ul>
                                <li>Basis of Play's Non-Blocking IO (for now)</li>
                                <li>Enumerator => Enumeratee(s) => Iteratee</li>
                                <li>Play makes it pretty easy</li>
                                <li>Only supported in Scala</li>
                            </ul>
                        </div>
                    </section>
                    <section>
                        <h3>SSE</h3>
                        <pre><code>
val (stream, channel) = Concurrent.broadcast[JsValue]

WS.url(s"https://stream.twitter.com/1.1/statuses/filter.json").
    sign(signature).
    withQueryString("track" -> URLDecoder.decode(query, "UTF-8")).
    postAndRetrieveStream("")(_ => Iteratee.foreach[Array[Byte]] {
        data => channel.push(Json.parse(data))
    };

Ok.feed(stream &>
    Concurrent.buffer(100) &>
    Enumeratee.map[JsValue](simplifyResponse) &>
    EventSource()).as("text/event-stream")
                        </code></pre>
                    </section>
                    <section>
                        <h3>WebSockets</h3>
                        <div align="left">
                            <ul>
                                <li>Socket communications over the original HTTP connection</li>
                                <li>Low-level -- not HTTP (define your own protocol)</li>
                                <li>High-frequency two-way communications between client and server</li>
                                <li>Can be implemented with Iteratees or Akka Actors</li>
                            </ul>
                        </div>
                    </section>
                    <section>
                        <h3>WebSockets (using Iteratees)</h3>
                        <pre><code>
def filter(query: String) = WebSocket.using[JsValue] { request =>
    auth.map { signature =>
    val (stream, channel) = Concurrent.broadcast[JsValue]
    var chunkCache = ""

    WS.url(s"https://stream.twitter.com/1.1/statuses/filter.json").
        sign(signature).
        withQueryString("track" -> URLDecoder.decode(query, "UTF-8")).
        postAndRetrieveStream("")(_ => Iteratee.foreach[Array[Byte]] { data => channel.push(Json.parse(data)) })

    val in = Iteratee.ignore[JsValue]

    val out = stream &>
        Concurrent.buffer(100) &>
        Enumeratee.take(100) &>
        Enumeratee.map[JsValue](simplifyResponse)

    (in, out)
} getOrElse {
    val response: JsValue = Json.obj("error" ->
    "Please configure twitter authentication using the twitter.conf file")
    (Iteratee.ignore[JsValue], Enumerator(response) >>> Enumerator.eof)
    }
}
                        </code></pre>
                    </section>
                </section>
                <section>
                    <section>
                        <h3>Agenda</h3>
                        <ul>
                            <li>Getting Started</li>
                            <li>Development Process</li>
                            <li>Error Handling</li>
                            <li>Database</li>
                            <li>Reactive Architecture (Non-Blocking IO)</li>
                            <li>Web Services</li>
                            <li>Real-time Communications
                                <ul>
                                    <li>Server-Sent Events</li>
                                    <li>Websockets</li>
                                </ul>
                            </li>
                            <li><b>Community</b></li>
                        </ul>

                    </section>
                    <section>
                        <h3>Community</h3>
                        <div align="left">
                            <ul>
                                <li>Open Source - <a href="https://github.com/playframework/">https://github.com/playframework/</a></li>
                                <li>Google Group - <a href="https://groups.google.com/forum/#!forum/play-framework">https://groups.google.com/forum/#!forum/play-framework</a></li>
                                <li>Stack Overflow - <a href="http://stackoverflow.com/tags/playframework">http://stackoverflow.com/tags/playframework</a></li>
                            </ul>
                        </div>
                    </section>
                </section>
                <section>
                    <h2>What's next?</h2>
                    <div align="left">
                        <ul>
                            <li class="fragment">
                                Play 2.4
                                <ul>
                                    <li>Improved deployment</li>
                                    <li>Experimental support for Reactive Streams</li>
                                    <li>Switch from Anorm to Slick for default Scala DB</li>
                                    <li>Switch from EBean to JPA for default Java DB</li>
                                </ul>
                            </li>
                            <li class="fragment">
                                Play 3.0
                                <ul>
                                    <li>Require Java 8</li>
                                    <li>Reactive Streams replace Iteratees as the base IO</li>
                                    <li>Improve Java APIs for async request/reply handling</li>
                                    <li>..and more!</li>
                                </ul>

                            </li>
                        </ul>
                    </div>
                </section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
